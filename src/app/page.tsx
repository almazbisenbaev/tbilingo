'use client';

import { useEffect } from 'react';
import SettingsDrawer from '@/components/SettingsDrawer';
import CourseLink from '@/components/CourseLink';
import PWAInstallPrompt from '@/components/PWAInstallPrompt';
import { useProgressStore } from '@/stores/progressStore';
import { alphabet } from '@/data/alphabet';
import { numbers } from '@/data/numbers';

export default function App() {
  const {
    getCourseProgress,
    initializeCourse
  } = useProgressStore();

  // Initialize courses with their total item counts
  useEffect(() => {
    initializeCourse('alphabet', alphabet.length);
    initializeCourse('numbers', numbers.length);
  }, [initializeCourse]);

  // Get progress data for both courses
  const alphabetProgress = getCourseProgress('alphabet');
  const numbersProgress = getCourseProgress('numbers');
  return (
    <>
      <div className="welcome">
        <div className="welcome-body">
          <div className="welcome-header">
            <div className="welcome-logo">
                <svg width="109" height="44" viewBox="0 0 109 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14.2978 12.46C14.4152 13.78 14.4885 15.1 14.5178 16.42C14.5765 17.74 14.6645 19.06 14.7818 20.38C14.8405 21.2307 14.8845 22.0813 14.9138 22.932C14.9725 23.7827 15.0312 24.6333 15.0898 25.484C15.1485 26.7453 15.2072 27.992 15.2658 29.224C15.3538 30.4267 15.4565 31.644 15.5738 32.876C15.6032 33.0813 15.6472 33.3013 15.7058 33.536C15.7645 33.7413 15.8085 33.9613 15.8378 34.196C15.8672 34.4013 15.8378 34.6213 15.7498 34.856C15.6618 35.0907 15.5152 35.2813 15.3098 35.428C14.8698 35.7213 14.4005 35.6773 13.9018 35.296C13.5205 35.0027 13.2418 34.592 13.0658 34.064C12.8018 33.4773 12.5965 32.8613 12.4498 32.216C12.3032 31.5413 12.1712 30.8813 12.0538 30.236C11.7605 28.388 11.5258 26.5253 11.3498 24.648C11.1738 22.7707 11.0418 20.8933 10.9538 19.016C10.9245 18.3413 10.8805 17.6667 10.8218 16.992C10.7632 16.288 10.7192 15.6133 10.6898 14.968C10.6018 12.68 10.5578 10.392 10.5578 8.104C10.5578 7.60534 10.5725 7.12134 10.6018 6.652C10.6312 6.15334 10.6752 5.66934 10.7338 5.2C10.7925 4.90667 10.7925 4.73067 10.7338 4.672C10.7045 4.584 10.5578 4.54 10.2938 4.54C9.1205 4.56934 7.94717 4.61334 6.77384 4.672C5.6005 4.73067 4.4565 4.848 3.34184 5.024C3.1365 5.05334 2.9165 5.08267 2.68184 5.112C2.4765 5.112 2.2565 5.09734 2.02184 5.068C1.3765 4.92134 0.936504 4.52534 0.701837 3.88C0.525837 3.176 0.775171 2.604 1.44984 2.164C1.74317 1.92934 2.10984 1.78267 2.54984 1.724C3.78184 1.40134 4.99917 1.18134 6.20184 1.064C7.43384 0.917336 8.68051 0.829336 9.94184 0.800003C10.9978 0.800003 12.0538 0.829336 13.1098 0.888002C14.1658 0.946668 15.2218 1.02 16.2778 1.108C17.5685 1.22534 18.8445 1.372 20.1058 1.548C21.3965 1.724 22.6578 2.01734 23.8898 2.428C24.0952 2.48667 24.2858 2.56 24.4618 2.648C24.6672 2.70667 24.8725 2.79467 25.0778 2.912C25.8698 3.23467 26.1925 3.76267 26.0458 4.496C25.8992 5.2 25.4152 5.552 24.5938 5.552C23.7432 5.552 22.8925 5.53734 22.0418 5.508C21.2205 5.47867 20.3845 5.40534 19.5338 5.288C18.7712 5.17067 17.9938 5.08267 17.2018 5.024C16.4098 4.936 15.6178 4.848 14.8258 4.76C14.5618 4.70134 14.4005 4.716 14.3418 4.804C14.3125 4.86267 14.2978 5.024 14.2978 5.288C14.2392 5.87467 14.2245 6.476 14.2538 7.092C14.2832 7.708 14.2978 8.30933 14.2978 8.896V12.46Z" fill="#FF7658"/>
                    <path d="M26.4982 17.608C26.5569 17.5787 26.6155 17.5493 26.6742 17.52C26.7622 17.4907 26.8355 17.4613 26.8942 17.432C27.8329 16.904 28.7715 16.6987 29.7102 16.816C30.6782 16.9333 31.5875 17.2853 32.4382 17.872C33.2302 18.4293 33.8462 19.104 34.2862 19.896C34.7262 20.6587 35.0489 21.48 35.2542 22.36C35.6942 24.1787 35.7675 25.9533 35.4742 27.684C35.2102 29.4147 34.5209 31.0573 33.4062 32.612C32.8195 33.4627 32.1155 34.1667 31.2942 34.724C30.5022 35.252 29.5782 35.604 28.5222 35.78C28.1702 35.8093 27.8035 35.8093 27.4222 35.78C27.0702 35.7507 26.7329 35.6773 26.4102 35.56C26.2635 35.5013 26.1169 35.472 25.9702 35.472C25.8235 35.4427 25.6622 35.5013 25.4862 35.648C25.0755 36 24.6209 36.1467 24.1222 36.088C23.6235 36.0293 23.1835 35.824 22.8022 35.472C22.4209 35.0907 22.2155 34.6213 22.1862 34.064C22.1275 33.1253 22.1129 32.2013 22.1422 31.292C22.1715 30.3827 22.2302 29.4733 22.3182 28.564C22.4355 27.6253 22.4795 26.716 22.4502 25.836C22.4502 24.9267 22.4355 24.0173 22.4062 23.108C22.4062 21.4653 22.3769 19.852 22.3182 18.268C22.2889 16.684 22.2449 15.0853 22.1862 13.472C22.1569 12.3573 22.1275 11.2573 22.0982 10.172C22.0982 9.08667 22.1569 7.98667 22.2742 6.872C22.3329 6.168 22.4209 5.464 22.5382 4.76C22.6555 4.02667 22.8462 3.33734 23.1102 2.692C23.3155 2.19334 23.6675 1.84134 24.1662 1.636C24.5769 1.43067 24.9582 1.43067 25.3102 1.636C25.6622 1.84134 25.8382 2.17867 25.8382 2.648C25.9262 5.024 25.9995 7.41467 26.0582 9.82C26.1462 12.196 26.2195 14.572 26.2782 16.948C26.3369 17.0653 26.3515 17.168 26.3222 17.256C26.3222 17.344 26.3809 17.4613 26.4982 17.608ZM26.5422 28.3H26.6302V30.412C26.6302 30.9987 26.7182 31.38 26.8942 31.556C27.0995 31.7027 27.4955 31.7173 28.0822 31.6C28.3755 31.5707 28.6395 31.4827 28.8742 31.336C29.1382 31.16 29.3729 30.9693 29.5782 30.764C30.1942 30.148 30.6342 29.444 30.8982 28.652C31.1035 28.0653 31.2649 27.4787 31.3822 26.892C31.4995 26.276 31.5435 25.6453 31.5142 25C31.5142 24.032 31.2942 23.108 30.8542 22.228C30.7369 21.9933 30.6049 21.788 30.4582 21.612C30.3115 21.436 30.1355 21.2893 29.9302 21.172C29.2849 20.7613 28.7715 20.8493 28.3902 21.436C27.9209 22.2867 27.4662 23.1667 27.0262 24.076C26.6155 24.956 26.4395 25.9533 26.4982 27.068C26.5275 27.2733 26.5422 27.4787 26.5422 27.684C26.5422 27.8893 26.5422 28.0947 26.5422 28.3Z" fill="#FF7658"/>
                    <path d="M41.626 14.264C40.7753 14.6453 40.042 14.528 39.426 13.912C39.2206 13.6773 39.0886 13.3693 39.03 12.988C38.9713 12.6067 39.0153 12.24 39.162 11.888C39.338 11.5067 39.6313 11.1987 40.042 10.964C40.4526 10.7 40.8633 10.568 41.274 10.568C42.1246 10.568 42.6966 10.964 42.99 11.756C43.1366 12.108 43.1513 12.4747 43.034 12.856C42.946 13.208 42.7406 13.516 42.418 13.78C42.3006 13.8973 42.1686 14 42.022 14.088C41.9046 14.1467 41.7726 14.2053 41.626 14.264ZM43.386 32.524C43.5033 33.14 43.3126 33.58 42.814 33.844C42.286 34.108 41.758 34.0493 41.23 33.668C40.9953 33.4627 40.8193 33.228 40.702 32.964C40.5846 32.7 40.4673 32.4213 40.35 32.128C40.262 31.7173 40.174 31.292 40.086 30.852C40.0273 30.412 39.9686 29.9867 39.91 29.576C39.734 28.1093 39.5873 26.6427 39.47 25.176C39.382 23.68 39.3966 22.1987 39.514 20.732C39.5433 20.4093 39.5873 20.0867 39.646 19.764C39.7046 19.412 39.8366 19.0893 40.042 18.796C40.1886 18.5027 40.3793 18.268 40.614 18.092C40.878 17.916 41.186 17.828 41.538 17.828C42.2126 17.8573 42.6966 18.2093 42.99 18.884C43.254 19.412 43.386 19.984 43.386 20.6V26.672C43.3566 27.024 43.3273 27.4493 43.298 27.948C43.2686 28.4467 43.254 28.9893 43.254 29.576C43.254 30.0453 43.254 30.5293 43.254 31.028C43.2833 31.5267 43.3273 32.0253 43.386 32.524Z" fill="#FF7658"/>
                    <path d="M50.8993 31.82C50.8993 32.2307 50.914 32.656 50.9433 33.096C50.9726 33.536 50.958 33.9907 50.8993 34.46C50.8993 34.5773 50.8993 34.724 50.8993 34.9C50.8993 35.0467 50.8846 35.208 50.8553 35.384C50.7673 35.9707 50.4593 36.3227 49.9313 36.44C49.3446 36.4693 48.8753 36.2933 48.5233 35.912C48.318 35.6773 48.1566 35.4133 48.0393 35.12C47.9513 34.8267 47.8486 34.5333 47.7313 34.24C47.614 33.712 47.5113 33.184 47.4233 32.656C47.3646 32.128 47.3206 31.6 47.2913 31.072C47.1153 29.4587 46.998 27.8453 46.9393 26.232C46.91 24.6187 46.866 23.0053 46.8073 21.392C46.778 19.0747 46.7486 16.772 46.7193 14.484C46.7193 12.196 46.734 9.89334 46.7633 7.576C46.7633 7.37067 46.7633 7.18 46.7633 7.004C46.7926 6.79867 46.8366 6.59334 46.8953 6.388C47.042 5.97734 47.2766 5.64 47.5993 5.376C47.922 5.08267 48.3033 4.936 48.7433 4.936C49.6526 4.936 50.2393 5.42 50.5033 6.388C50.5913 6.652 50.6353 6.916 50.6353 7.18C50.7526 9.08667 50.826 10.9933 50.8553 12.9C50.914 14.8067 50.958 16.7133 50.9873 18.62C50.9873 18.8253 50.9873 19.3093 50.9873 20.072C50.9873 20.8347 50.9873 21.744 50.9873 22.8C50.9873 23.8267 50.9726 24.912 50.9433 26.056C50.9433 27.2 50.9433 28.2853 50.9433 29.312C50.9433 30.3093 50.9286 31.1453 50.8993 31.82Z" fill="#FF7658"/>
                    <path d="M56.9228 14.264C56.0722 14.6453 55.3388 14.528 54.7228 13.912C54.5175 13.6773 54.3855 13.3693 54.3268 12.988C54.2682 12.6067 54.3122 12.24 54.4588 11.888C54.6348 11.5067 54.9282 11.1987 55.3388 10.964C55.7495 10.7 56.1602 10.568 56.5708 10.568C57.4215 10.568 57.9935 10.964 58.2868 11.756C58.4335 12.108 58.4482 12.4747 58.3308 12.856C58.2428 13.208 58.0375 13.516 57.7148 13.78C57.5975 13.8973 57.4655 14 57.3188 14.088C57.2015 14.1467 57.0695 14.2053 56.9228 14.264ZM58.6828 32.524C58.8002 33.14 58.6095 33.58 58.1108 33.844C57.5828 34.108 57.0548 34.0493 56.5268 33.668C56.2922 33.4627 56.1162 33.228 55.9988 32.964C55.8815 32.7 55.7642 32.4213 55.6468 32.128C55.5588 31.7173 55.4708 31.292 55.3828 30.852C55.3242 30.412 55.2655 29.9867 55.2068 29.576C55.0308 28.1093 54.8842 26.6427 54.7668 25.176C54.6788 23.68 54.6935 22.1987 54.8108 20.732C54.8402 20.4093 54.8842 20.0867 54.9428 19.764C55.0015 19.412 55.1335 19.0893 55.3388 18.796C55.4855 18.5027 55.6762 18.268 55.9108 18.092C56.1748 17.916 56.4828 17.828 56.8348 17.828C57.5095 17.8573 57.9935 18.2093 58.2868 18.884C58.5508 19.412 58.6828 19.984 58.6828 20.6V26.672C58.6535 27.024 58.6242 27.4493 58.5948 27.948C58.5655 28.4467 58.5508 28.9893 58.5508 29.576C58.5508 30.0453 58.5508 30.5293 58.5508 31.028C58.5802 31.5267 58.6242 32.0253 58.6828 32.524Z" fill="#FF7658"/>
                    <path d="M70.7722 24.34C70.2442 24.8093 69.8628 25.2933 69.6282 25.792C69.0122 26.8773 68.5135 28.0213 68.1322 29.224C67.7508 30.4267 67.4575 31.6587 67.2522 32.92C67.2228 33.2133 67.1642 33.5067 67.0762 33.8C66.9882 34.0933 66.8708 34.3573 66.7242 34.592C66.2842 35.3253 65.6975 35.648 64.9642 35.56C64.5828 35.56 64.2602 35.4573 63.9962 35.252C63.7322 35.0467 63.4975 34.7827 63.2922 34.46C63.1748 34.196 63.0868 33.9173 63.0282 33.624C62.9988 33.3307 62.9548 33.0373 62.8962 32.744C62.7495 31.5707 62.5882 30.3973 62.4122 29.224C62.2655 28.0213 62.1628 26.8333 62.1042 25.66C62.0455 24.868 62.0455 24.076 62.1042 23.284C62.1628 22.492 62.2508 21.7 62.3682 20.908C62.3682 20.7613 62.3975 20.6293 62.4562 20.512C62.5148 20.3653 62.5588 20.2333 62.5882 20.116C62.8522 19.3827 63.3362 19.06 64.0402 19.148C64.3335 19.1773 64.5975 19.3093 64.8322 19.544C65.0669 19.7787 65.1988 20.0573 65.2282 20.38C65.3162 21.084 65.3895 21.7733 65.4482 22.448C65.5362 23.1227 65.6388 23.7973 65.7562 24.472C65.7855 24.5893 65.8002 24.736 65.8002 24.912C65.8002 25.0587 65.8442 25.2053 65.9322 25.352C66.0788 25.2933 66.1668 25.22 66.1962 25.132C66.2255 25.0147 66.2548 24.912 66.2842 24.824C66.5775 24.2373 66.8709 23.6653 67.1642 23.108C67.4575 22.5213 67.7948 21.9933 68.1762 21.524C68.3522 21.2893 68.5282 21.0693 68.7042 20.864C68.8802 20.6293 69.0855 20.424 69.3202 20.248C70.0828 19.632 70.9042 19.3973 71.7842 19.544C72.6642 19.6613 73.3829 20.1453 73.9402 20.996C74.2042 21.4653 74.4095 21.964 74.5562 22.492C74.7028 22.9907 74.8055 23.504 74.8642 24.032C75.0108 24.912 75.1282 25.8067 75.2162 26.716C75.3335 27.596 75.4509 28.476 75.5682 29.356C75.6268 29.884 75.7002 30.412 75.7882 30.94C75.9055 31.4387 75.9935 31.952 76.0522 32.48C76.1109 32.6853 76.1842 32.8613 76.2722 33.008C76.3602 33.1547 76.5068 33.3013 76.7122 33.448C77.3282 33.7707 77.5188 34.284 77.2842 34.988C77.0202 35.7213 76.5655 36.176 75.9202 36.352C75.2748 36.528 74.6588 36.3813 74.0722 35.912C73.8082 35.6773 73.5882 35.428 73.4122 35.164C73.2362 34.9 73.0749 34.6213 72.9282 34.328C72.4589 33.4773 72.1069 32.612 71.8722 31.732C71.6375 30.852 71.4615 29.928 71.3442 28.96C71.2562 28.2853 71.1829 27.596 71.1242 26.892C71.0655 26.188 70.9629 25.4987 70.8162 24.824C70.8162 24.7653 70.8015 24.7067 70.7722 24.648C70.7722 24.56 70.7722 24.4573 70.7722 24.34Z" fill="#FF7658"/>
                    <path d="M87.4451 29.312C87.3278 29.576 87.1958 29.84 87.0491 30.104C86.9318 30.368 86.7998 30.632 86.6531 30.896C86.5064 31.248 86.3158 31.6 86.0811 31.952C85.8464 32.304 85.5824 32.612 85.2891 32.876C84.5558 33.5507 83.7491 33.8733 82.8691 33.844C81.9891 33.8147 81.2118 33.4187 80.5371 32.656C80.1558 32.2453 79.8478 31.776 79.6131 31.248C79.4078 30.6907 79.2318 30.1333 79.0851 29.576C78.4104 27.024 78.5424 24.516 79.4811 22.052C79.7744 21.26 80.1411 20.512 80.5811 19.808C81.0504 19.104 81.6518 18.5027 82.3851 18.004C83.1184 17.5053 83.8664 17.1973 84.6291 17.08C85.3918 16.9333 86.1838 17.0213 87.0051 17.344C87.2398 17.4027 87.4451 17.4467 87.6211 17.476C87.8264 17.5053 88.0318 17.4613 88.2371 17.344C88.8238 17.1093 89.3958 17.168 89.9531 17.52C90.5398 17.8427 90.8918 18.312 91.0091 18.928C91.1851 19.6907 91.3024 20.4533 91.3611 21.216C91.4198 21.9787 91.4638 22.7413 91.4931 23.504C91.5811 25.1467 91.6398 26.804 91.6691 28.476C91.6984 30.1187 91.6838 31.7613 91.6251 33.404C91.5958 34.196 91.5371 35.0027 91.4491 35.824C91.3904 36.616 91.2291 37.408 90.9651 38.2C90.7011 39.1093 90.3344 39.9453 89.8651 40.708C89.4251 41.5 88.8678 42.204 88.1931 42.82C87.6651 43.2893 87.0638 43.5973 86.3891 43.744C85.5384 43.92 84.7171 43.7293 83.9251 43.172C83.1624 42.6147 82.7078 41.9107 82.5611 41.06C82.5024 40.532 82.6638 40.1507 83.0451 39.916C83.1918 39.828 83.3531 39.7693 83.5291 39.74C83.7344 39.7107 83.9398 39.7547 84.1451 39.872C84.3211 39.96 84.4678 40.048 84.5851 40.136C84.7024 40.2533 84.8198 40.3853 84.9371 40.532C85.2011 40.7373 85.4651 40.6933 85.7291 40.4C86.2864 39.608 86.6678 38.772 86.8731 37.892C87.1958 36.5133 87.3864 35.1053 87.4451 33.668C87.5038 32.2013 87.5038 30.7493 87.4451 29.312ZM83.4411 29.356C83.7344 29.1213 83.9544 28.8573 84.1011 28.564C84.2771 28.2413 84.4531 27.8893 84.6291 27.508C84.9811 26.628 85.2744 25.7187 85.5091 24.78C85.7731 23.812 85.9784 22.8293 86.1251 21.832C86.2131 21.1573 85.9344 20.9227 85.2891 21.128C84.9371 21.2453 84.6291 21.436 84.3651 21.7C84.1304 21.964 83.9398 22.228 83.7931 22.492C83.6464 22.756 83.4998 23.0493 83.3531 23.372C83.0598 24.1053 82.8984 24.868 82.8691 25.66C82.8398 26.452 82.8691 27.244 82.9571 28.036C83.0158 28.2707 83.0598 28.5053 83.0891 28.74C83.1478 28.9453 83.2651 29.1507 83.4411 29.356Z" fill="#FF7658"/>
                    <path d="M108.129 26.276C107.983 29.1507 106.927 31.8347 104.961 34.328C104.609 34.7973 104.199 35.208 103.729 35.56C103.26 35.8827 102.732 36.132 102.145 36.308C101.001 36.572 99.9012 36.44 98.8452 35.912C98.4639 35.6773 98.0972 35.3987 97.7452 35.076C97.3932 34.724 97.0999 34.3573 96.8652 33.976C96.1025 32.7733 95.5892 31.5413 95.3252 30.28C95.0612 28.9893 94.9732 27.6693 95.0612 26.32C95.1785 25.1173 95.4425 23.9733 95.8532 22.888C96.2639 21.7733 96.8652 20.7613 97.6572 19.852C98.3319 19.1187 99.1385 18.664 100.077 18.488C100.517 18.3707 100.913 18.3707 101.265 18.488C101.617 18.576 101.955 18.752 102.277 19.016C102.365 19.104 102.468 19.1627 102.585 19.192C102.703 19.192 102.835 19.192 102.981 19.192C103.773 19.104 104.477 19.2213 105.093 19.544C105.739 19.8667 106.296 20.3507 106.765 20.996C107.293 21.7293 107.645 22.5213 107.821 23.372C108.027 24.1933 108.129 25.1613 108.129 26.276ZM101.881 22.976C101.559 22.976 101.221 23.02 100.869 23.108C100.576 23.108 100.356 23.1813 100.209 23.328C100.063 23.4747 99.9305 23.68 99.8132 23.944C99.4025 25.0293 99.1825 26.1147 99.1532 27.2C99.1532 28.2853 99.3145 29.3853 99.6372 30.5C99.8132 30.9693 100.092 31.4533 100.473 31.952C100.679 32.1573 100.825 32.2747 100.913 32.304C101.031 32.304 101.192 32.2013 101.397 31.996C101.661 31.732 101.911 31.468 102.145 31.204C102.409 30.9107 102.629 30.6027 102.805 30.28C102.952 29.928 103.099 29.5613 103.245 29.18C103.421 28.7987 103.553 28.4173 103.641 28.036C103.788 27.4787 103.905 26.9213 103.993 26.364C104.081 25.7773 104.052 25.1907 103.905 24.604C103.759 23.988 103.539 23.5627 103.245 23.328C102.952 23.0933 102.497 22.976 101.881 22.976Z" fill="#FF7658"/>
                </svg>
            </div>
            <div className="sr-only">Tbilingo</div>
            <h1 className='welcome-descr'>Your First Step to Learning Georgian</h1>
          </div>
          <div className="welcome-actions">
            <CourseLink 
              href="/alphabet"
              title="Learn Alphabet"
              icon="/images/icon-alphabet.svg"
              disabled={false}
              progress={alphabetProgress.completionPercentage}
              completedItems={alphabetProgress.learnedItems.length}
              totalItems={alphabetProgress.totalItems}
            />
            <CourseLink 
              href="/numbers"
              title="Learn Numbers"
              icon="/images/icon-numbers.svg"
              disabled={false}
              progress={numbersProgress.completionPercentage}
              completedItems={numbersProgress.learnedItems.length}
              totalItems={numbersProgress.totalItems}
            />
            <CourseLink 
              href="/"
              title="Learn Words & Phrases"
              icon="/images/icon-phrases.svg"
              disabled={true}
            />
          </div>
        </div>
        <PWAInstallPrompt />
        <div className="welcome-footer">
          <div className="credits">Made by <a target="_blank" href="https://www.threads.com/@almazbisenbaev">Almaz Bisenbaev</a></div>
        </div>
      </div>

      {/* Settings and interactive logic moved to client component */}
      <SettingsDrawer />

    </>
  );
}